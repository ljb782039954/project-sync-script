#!/bin/sh
# Git post-commit hook
# 自动同步到目标项目（增量同步模式）
# 
# 此 Hook 会在每次 git commit 后自动触发同步脚本
# 同步模式：增量同步（只同步变更的文件）

# 获取 Git 仓库根目录
GIT_ROOT="$(git rev-parse --show-toplevel 2>/dev/null)"
if [ -z "$GIT_ROOT" ]; then
    echo "警告: 无法确定 Git 仓库根目录"
    exit 0
fi

# 获取脚本所在目录（syncScript 目录）
SCRIPT_DIR="$GIT_ROOT/syncScript"

# 检查脚本是否存在
if [ ! -f "$SCRIPT_DIR/sync_to_target.sh" ]; then
    echo "警告: 同步脚本不存在: $SCRIPT_DIR/sync_to_target.sh"
    exit 0
fi

# 执行同步脚本（增量同步模式，不传 --all 参数）
"$SCRIPT_DIR/sync_to_target.sh"

exit 0

